<!-- Form tạo mới exercise khi exercise = null -->
<div class="create-exercise-container">
  <div class="create-form">
    <h1 class="title">Chi tiết bài tập lập trình mới</h1>

    <form class="exercise-form">
      <!-- Thông tin cơ bản -->
      <div class="form-section">
        <h2 class="section-title">Thông tin cơ bản</h2>

        <div class="form-group">
          <label for="topic">Chủ đề *</label>
          <input
            type="text"
            id="topic"
            name="topic"
            class="form-control"
            [(ngModel)]="formData.topic"
            required
          />
        </div>
      </div>

      <!-- Chi tiết lập trình -->
      <div class="form-section">
        <h2 class="section-title">Chi tiết lập trình</h2>

        <div class="form-group">
          <label for="input">Định dạng đầu vào *</label>
          <textarea
            id="input"
            name="input"
            class="form-control code-input"
            rows="3"
            [(ngModel)]="formData.input"
            required
          ></textarea>
        </div>

        <div class="form-group">
          <label for="output">Định dạng đầu ra *</label>
          <textarea
            id="output"
            name="output"
            class="form-control code-input"
            rows="3"
            [(ngModel)]="formData.output"
            required
          ></textarea>
        </div>

        <div class="form-group">
          <label for="constraintText">Các ràng buộc *</label>
          <textarea
            id="constraintText"
            name="constraintText"
            class="form-control code-input"
            rows="3"
            [(ngModel)]="formData.constraintText"
            required
          ></textarea>
        </div>

        <div class="form-group">
          <label for="timeLimit">Giới hạn thời gian thực thi mã (giây) *</label>
          <input
            type="number"
            id="timeLimit"
            name="timeLimit"
            class="form-control"
            min="1"
            [(ngModel)]="formData.timeLimit"
            required
          />
        </div>

        <div class="form-group">
          <label for="memoryLimit">Giới hạn bộ nhớ (MB) *</label>
          <input
            type="number"
            id="memoryLimit"
            name="memoryLimit"
            class="form-control"
            min="1"
            [(ngModel)]="formData.memoryLimit"
            required
          />
        </div>

        <div class="form-group">
          <label for="maxSubmissions">Lượt nộp tối đa *</label>
          <input
            type="number"
            id="maxSubmissions"
            name="maxSubmissions"
            class="form-control"
            min="1"
            [(ngModel)]="formData.maxSubmissions"
            required
          />
        </div>
      </div>

      <!-- Ngôn ngữ lập trình -->
      <div class="form-section">
        <h2 class="section-title">Ngôn ngữ lập trình được phép</h2>
        <div class="languages-container">
          <div
            class="language-checkbox"
            *ngFor="let lang of availableLanguages"
          >
            <input
              type="checkbox"
              [id]="'lang-' + lang"
              [checked]="isLanguageSelected(lang)"
              (change)="toggleLanguage(lang)"
            />
            <label [for]="'lang-' + lang">{{ lang }}</label>
          </div>
        </div>
      </div>

      <!-- Code template và solution -->
      <div class="form-section">
        <h2 class="section-title">Code template và giải pháp</h2>

        <div class="form-group">
          <label for="codeTemplate">Code template</label>
          <textarea
            id="codeTemplate"
            name="codeTemplate"
            class="form-control code-input"
            rows="6"
            [(ngModel)]="formData.codeTemplate"
            placeholder="// Code template cho học viên"
          ></textarea>
        </div>

        <div class="form-group">
          <label for="solution">Giải pháp *</label>
          <textarea
            id="solution"
            name="solution"
            class="form-control code-input"
            rows="8"
            [(ngModel)]="formData.solution"
            required
            placeholder="// Giải pháp mẫu"
          ></textarea>
        </div>
      </div>

      <!-- Test cases -->
      <div class="form-section">
        <h2 class="section-title">Test cases</h2>
        <div class="test-cases-container">
          <div
            class="test-case-item"
            *ngFor="let testCase of testCases; let i = index"
          >
            <h3>Test case {{ i + 1 }}</h3>
            <div class="test-case-form">
              <div class="form-group">
                <label>Input:</label>
                <textarea
                  [name]="'testCaseInput' + i"
                  class="form-control code-input"
                  rows="2"
                  [(ngModel)]="testCase.input"
                ></textarea>
              </div>
              <div class="form-group">
                <label>Expected Output:</label>
                <textarea
                  [name]="'testCaseOutput' + i"
                  class="form-control code-input"
                  rows="2"
                  [(ngModel)]="testCase.expectedOutput"
                ></textarea>
              </div>
              <div class="form-group">
                <label>Note (giải thích):</label>
                <textarea
                  [name]="'testCaseNote' + i"
                  class="form-control"
                  rows="2"
                  [(ngModel)]="testCase.note"
                ></textarea>
              </div>
              <div class="test-case-actions">
                <div class="form-group checkbox-group">
                  <input
                    [name]="'testCaseSample' + i"
                    type="checkbox"
                    [id]="'sample' + i"
                    [(ngModel)]="testCase.sample"
                  />
                  <label [for]="'sample' + i">Là test case mẫu</label>
                </div>
                <button
                  type="button"
                  class="btn btn-remove-testcase"
                  (click)="removeTestCase(i)"
                  title="Xóa test case này"
                >
                  <i class="fa fa-trash"></i>
                </button>
              </div>
            </div>
          </div>
          <button
            type="button"
            class="btn btn-add-testcase"
            (click)="addTestCase()"
          >
            Thêm test case
          </button>
        </div>
      </div>

      <!-- Action buttons -->
      <div class="form-actions">
        <button type="button" class="btn btn-secondary" (click)="goBack()">
          Hủy
        </button>
        <button
          type="submit"
          class="btn btn-primary"
          (click)="createExercise()"
        >
          Tạo bài tập
        </button>
      </div>
    </form>
  </div>
</div>
