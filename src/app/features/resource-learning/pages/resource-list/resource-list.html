<div class="resource-container">
  <div class="resource-list-container">
    <div class="resource-list-control">
      <div class="resource-list-filter">
        <app-input
          placeholder="Tìm kiếm tài nguyên..."
          [value]="resourcename"
          (valueChange)="handleInputChange($event)"
          [required]="false"
          [minLength]="3"
          [variant]="'primary'"
          [isSvg]="false"
          [icon]="'fa fa-search'"
        ></app-input>
      </div>
      @if(hasPermissionAction){
      <div class="resource-list-button">
        <app-button
          (onClick)="handleAdd()"
          [width]="'50px'"
          [height]="'50px'"
          variant="outline"
        >
          <span style="font-size: 24px">+</span>
        </app-button>
      </div>
      }
    </div>

    <div class="list-resource-card-container">
      @if (!isLoading && filteredResources) {
      <div
        class="list-resource-card"
        appScrollEnd
        (appScrollEnd)="loadNextPage()"
      >
        @for (resource of filteredResources; track resource) {
        <div>
          <app-resource-card
            [resource]="resource"
            [showControls]="true"
            (main)="goToDetail($event)"
            (edit)="selectedResourceId = $event"
            (delete)="deleteResource($event)"
          ></app-resource-card>
        </div>
        }
      </div>
      } @if (isLoading ) {
      <div class="list-resource-card">
        <app-skeleton-loading type="card" [count]="8"></app-skeleton-loading>
      </div>
      }
      <!-- Hiển thị thông báo "Không có dữ liệu" với hình ảnh động khi không có bài viết -->
      @if (!isLoading && (!filteredResources || filteredResources.length === 0))
      {
      <div class="no-data-container">
        <ng-lottie
          [options]="lottieOptions"
          style="width: 200px; height: 200px"
        >
        </ng-lottie>
        <p>Không có dữ liệu</p>
      </div>
      }
    </div>

    <!-- Hiển thị skeleton loading khi đang tải -->
    @if (isLoadingMore || isLoading) {
    <div class="list-post-card">
      <app-skeleton-loading type="card" [count]="8"></app-skeleton-loading>
    </div>
    }
  </div>
</div>

@if (selectedResourceId) {
<app-resource-edit-popup
  [resourceId]="selectedResourceId"
  (close)="handlePopupClose()"
  (updated)="handleResourceUpdated()"
></app-resource-edit-popup>
}
