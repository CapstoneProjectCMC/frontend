<!-- table.component.html -->
<div class="table-father">
  <table class="main-table">
    <thead class="table-header">
      @if (needNo) {
        <th style="text-align: center">STT</th>
      }
      @for (header of headers; track header) {
        <th>{{ header.label }}</th>
      }
      @if (needDelete || needEdit || needViewResult || needswitch) {
        <th
          style="min-width: 100px; text-align: center"
        ></th>
      }
    </thead>
    <tbody class="table-content">
      @for (row of data; track row; let i = $index) {
        <tr>
          @if (needNo) {
            <td style="text-align: center" [attr.data-label]="'STT'">
              {{
              i + 1 + amountDataPerPage * (currentIndex ? currentIndex - 1 : 0)
              }}
            </td>
          }
          @for (header of headers; track header) {
            <td
              [ngClass]="header.value + '-column'"
              [attr.data-label]="header.label"
              >
              @if (templateMap[header.value]) {
                <ng-container
              *ngTemplateOutlet="
                templateMap[header.value];
                context: { $implicit: row, rowIndex: i }
              "
                ></ng-container>
              } @else {
                {{ row[header.value] }}
              }
            </td>
          }
          @if (needDelete || needEdit || needViewResult || needswitch) {
            <td>
              <div class="btn-actions">
                @if (needEdit) {
                  <div class="edit">
                    <svg
                      xmlns="http://www.w3.org/2000/svg"
                      width="24"
                      height="24"
                      style="cursor: pointer; width: 24px; height: 24px"
                      (click)="handleEditClick(row[idSelect])"
                      viewBox="0 0 24 24"
                      fill="none"
                      stroke="currentColor"
                      stroke-width="2"
                      stroke-linecap="round"
                      stroke-linejoin="round"
                      class="lucide lucide-square-pen-icon lucide-square-pen"
                      >
                      <path
                        d="M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"
                        />
                        <path
                          d="M18.375 2.625a1 1 0 0 1 3 3l-9.013 9.014a2 2 0 0 1-.853.505l-2.873.84a.5.5 0 0 1-.62-.62l.84-2.873a2 2 0 0 1 .506-.852z"
                          />
                        </svg>
                      </div>
                    }
                    @if (needDelete) {
                      <div class="delete">
                        <svg
                          xmlns="http://www.w3.org/2000/svg"
                          width="24"
                          height="24"
                          (click)="handleDeleteClick(row[idSelect])"
                          style="cursor: pointer; width: 24px; height: 24px"
                          viewBox="0 0 24 24"
                          fill="none"
                          stroke="currentColor"
                          stroke-width="2"
                          stroke-linecap="round"
                          stroke-linejoin="round"
                          class="lucide lucide-trash2-icon lucide-trash-2"
                          >
                          <path d="M10 11v6" />
                          <path d="M14 11v6" />
                          <path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6" />
                          <path d="M3 6h18" />
                          <path d="M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2" />
                        </svg>
                      </div>
                    }
                    @if (needswitch) {
                      <div class="switch">
                        @if (row[switchField] === lockValue) {
                          <svg
                            xmlns="http://www.w3.org/2000/svg"
                            width="24"
                            height="24"
                            style="cursor: pointer; width: 24px; height: 24px"
                            (click)="onSwitchClick(row)"
                            viewBox="0 0 24 24"
                            fill="none"
                            stroke="currentColor"
                            stroke-width="2"
                            stroke-linecap="round"
                            stroke-linejoin="round"
                            class="lucide lucide-lock-icon lucide-lock"
                            >
                            <rect width="18" height="11" x="3" y="11" rx="2" ry="2" />
                            <path d="M7 11V7a5 5 0 0 1 10 0v4" />
                          </svg>
                        }
                        @if (row[switchField] === openValue) {
                          <svg
                            xmlns="http://www.w3.org/2000/svg"
                            width="24"
                            height="24"
                            style="cursor: pointer; width: 24px; height: 24px"
                            (click)="onSwitchClick(row)"
                            viewBox="0 0 24 24"
                            fill="none"
                            stroke="currentColor"
                            stroke-width="2"
                            stroke-linecap="round"
                            stroke-linejoin="round"
                            class="lucide lucide-lock-open-icon lucide-lock-open"
                            >
                            <rect width="18" height="11" x="3" y="11" rx="2" ry="2" />
                            <path d="M7 11V7a5 5 0 0 1 9.9-1" />
                          </svg>
                        }
                        @if (row[switchField] === pendingValue) {
                          <div
                            class="pending-button"
                            >
                            <app-button
                              (onClick)="onSwitchClick(row)"
                              variant="solid"
                              [width]="'30px'"
                              [height]="'30px'"
                              ><svg
                              xmlns="http://www.w3.org/2000/svg"
                              width="24"
                              height="24"
                              viewBox="0 0 24 24"
                              fill="none"
                              stroke="currentColor"
                              stroke-width="2"
                              stroke-linecap="round"
                              stroke-linejoin="round"
                              class="lucide lucide-check-icon lucide-check"
                              >
                              <path d="M20 6 9 17l-5-5" />
                            </svg>
                          </app-button>
                          <app-button
                            (onClick)="onSwitchClick(row)"
                            variant="outline"
                            [width]="'29px'"
                            [height]="'30px'"
                            >
                            <svg
                              xmlns="http://www.w3.org/2000/svg"
                              width="24"
                              height="24"
                              viewBox="0 0 24 24"
                              fill="none"
                              stroke="currentColor"
                              stroke-width="2"
                              stroke-linecap="round"
                              stroke-linejoin="round"
                              class="lucide lucide-x-icon lucide-x"
                              >
                              <path d="M18 6 6 18" />
                              <path d="m6 6 12 12" />
                            </svg>
                          </app-button>
                        </div>
                      }
                    </div>
                  }
                  @if (needViewResult) {
                    <app-interactive-button
                      [buttonText]="'Result'"
                      [buttonType]="'primary'"
                      [buttonSize]="'small'"
                      (buttonClick)="handleNavigation(row['id'], row['userId'])"
                      class="result"
                      >
                      <div class="view-icon"></div>
                    </app-interactive-button>
                  }
                </div>
              </td>
            }
          </tr>
        }
      </tbody>
    </table>
  </div>
