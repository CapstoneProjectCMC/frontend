<div class="excercise-card-container" (click)="onTitleClick()">
  <div class="info-card" [class.border]="role !== typeRoles.admin">
    <div class="title-header">
      <div class="card-header">
        <h2 class="title" [title]="data.title">
          {{ data.title | truncate : 30 }}
        </h2>
      </div>

      <div class="metadata">
        <div class="uploader-info">
          <img
            [src]="data.uploader.avatar || avatarDefault"
            [alt]="data.uploader.name"
            class="avatar"
            (error)="handleImageError($event)"
          />
          <span class="username">{{ data.uploader.name || "Ẩn danh" }}</span>
        </div>
        <div class="timestamp" [title]="data.uploadTime | date : 'full'">
          {{ getTimeAgo(data.uploadTime) }}
        </div>
      </div>
    </div>

    <div class="description">
      <p [class.clamp-2-lines]="!isExpanded" [class.expanded]="isExpanded">
        {{ data.description }}
      </p>
      @if (data.description.length > 300) {
      <button (click)="toggleDescription($event)" class="read-more">
        {{ isExpanded ? "Read Less" : "Read More" }}
      </button>
      }
    </div>

    <div
      class="difficulty"
      [attr.aria-label]="'Difficulty: ' + data.difficulty"
    >
      <div class="part-difficulty">
        <div class="difficulty-badge" [ngClass]="data.difficulty">
          {{
            data.difficulty === "EASY"
              ? "Dễ"
              : data.difficulty === "MEDIUM"
              ? "Trung bình"
              : data.difficulty === "HARD"
              ? "Khó"
              : (data.difficulty | titlecase)
          }}
        </div>
        <div class="difficulty-stars">
          <!-- <span
            class="star"
            *ngFor="let star of difficultyStars"
            [class.filled]="star <= difficultyLevel"
            >
            ★
          </span> -->
        </div>
      </div>
      <div class="part-type-ex">
        <i
          [ngClass]="
            data.type === 'CODING'
              ? 'fas fa-code'
              : 'fa-regular fa-circle-check'
          "
        ></i>
        {{ data.type === "CODING" ? "Viết mã" : "Trắc nghiệm" }}
      </div>
    </div>

    <div class="tags-container">
      @if (showScrollButtons) {
      <button class="scroll-btn left" (click)="scrollLeft($event)">‹</button>
      }

      <div class="tags-scroll" #tagsScroll>
        @for (tag of data.tags; track tag) {
        <span class="tag" [attr.aria-label]="'Tag: ' + tag"> #{{ tag }} </span>
        }
      </div>

      @if (showScrollButtons) {
      <button class="scroll-btn right" (click)="scrollRight($event)">›</button>
      } @if(authenticated){
      <button
        class="save-btn"
        [class.saved]="isSaved"
        (click)="toggleSave($event)"
        aria-label="Save item"
        title="Lưu bài tập này"
      >
        <span class="save-icon">{{ isSaved ? "★" : "☆" }}</span></button
      >}
    </div>

    <!-- <div class="actions">
    <div class="status-toggle">
      <button
        class="toggle-btn"
        [class.completed]="data.status === 'completed'"
        (click)="toggleStatus()"
        [attr.aria-label]="'Toggle status: Currently ' + data.status"
        >
        <span class="toggle-icon">{{
          data.status === "completed" ? "✓" : "⧖"
        }}</span>
        {{ data.status | titlecase }}
      </button>
    </div>
    <button
      class="save-btn"
      [class.saved]="isSaved"
      (click)="toggleSave()"
      aria-label="Save item"
      >
      <span class="save-icon">{{ isSaved ? "★" : "☆" }}</span>
    </button>
  </div> -->
  </div>

  <!-- Phần này không sử dụng nữa, đã tạm ẩn -->
  <!-- <div
class="admin-actions"
[class.accepted]="data.approval === 'accepted'"
[class.pending]="data.approval === 'pending'"
[class.rejected]="data.approval === 'rejected'"
*ngIf="role === typeRoles.admin && false"
>
<button
  class="delete-btn"
  (click)="onDelete()"
  *ngIf="data.approval !== 'pending'"
  >
  <i class="fas fa-trash"></i>
</button>
<button
  class="edit-btn"
  (click)="onEdit()"
  *ngIf="data.approval !== 'pending'"
  >
  <i class="fas fa-edit"></i>
</button>

<ng-container *ngIf="data.approval === 'pending'">
  <button class="accept-btn" (click)="onApprove('accepted')">
    Chấp nhận
  </button>
  <button class="reject-btn" (click)="onApprove('rejected')">
    Từ chối
  </button>
</ng-container>
</div> -->
</div>
